<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>6 Map observation data | Mapping INBO color ring data to SOVON format</title>
  <meta name="description" content="6 Map observation data | Mapping INBO color ring data to SOVON format">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="6 Map observation data | Mapping INBO color ring data to SOVON format" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="inbo/sovon" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Map observation data | Mapping INBO color ring data to SOVON format" />
  
  
  

<meta name="author" content="Damiano Oldoni">


<meta name="date" content="2019-03-26">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="3_birds.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Intro</a></li>
<li class="chapter" data-level="2" data-path="1_preprocessing.html"><a href="1_preprocessing.html"><i class="fa fa-check"></i><b>2</b> Extract data from INBO kleurring database</a><ul>
<li class="chapter" data-level="2.1" data-path="1_preprocessing.html"><a href="1_preprocessing.html#connection-to-inbo-database"><i class="fa fa-check"></i><b>2.1</b> Connection to INBO database</a></li>
<li class="chapter" data-level="2.2" data-path="1_preprocessing.html"><a href="1_preprocessing.html#import-data"><i class="fa fa-check"></i><b>2.2</b> Import data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="1_preprocessing.html"><a href="1_preprocessing.html#extract-user-data"><i class="fa fa-check"></i><b>2.2.1</b> Extract user data</a></li>
<li class="chapter" data-level="2.2.2" data-path="1_preprocessing.html"><a href="1_preprocessing.html#extract-color-ring-data"><i class="fa fa-check"></i><b>2.2.2</b> Extract color ring data</a></li>
<li class="chapter" data-level="2.2.3" data-path="1_preprocessing.html"><a href="1_preprocessing.html#extract-observation-data"><i class="fa fa-check"></i><b>2.2.3</b> Extract observation data</a></li>
<li class="chapter" data-level="2.2.4" data-path="1_preprocessing.html"><a href="1_preprocessing.html#import-control-data"><i class="fa fa-check"></i><b>2.2.4</b> Import control data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="1_preprocessing.html"><a href="1_preprocessing.html#pre-processing"><i class="fa fa-check"></i><b>3</b> Pre-processing</a><ul>
<li class="chapter" data-level="3.1" data-path="1_preprocessing.html"><a href="1_preprocessing.html#preview-raw-data"><i class="fa fa-check"></i><b>3.1</b> Preview raw data</a></li>
<li class="chapter" data-level="3.2" data-path="1_preprocessing.html"><a href="1_preprocessing.html#check-primary-key-consistency"><i class="fa fa-check"></i><b>3.2</b> Check primary key consistency</a><ul>
<li class="chapter" data-level="3.2.1" data-path="1_preprocessing.html"><a href="1_preprocessing.html#users"><i class="fa fa-check"></i><b>3.2.1</b> Users</a></li>
<li class="chapter" data-level="3.2.2" data-path="1_preprocessing.html"><a href="1_preprocessing.html#birds"><i class="fa fa-check"></i><b>3.2.2</b> Birds</a></li>
<li class="chapter" data-level="3.2.3" data-path="1_preprocessing.html"><a href="1_preprocessing.html#observations"><i class="fa fa-check"></i><b>3.2.3</b> Observations</a></li>
<li class="chapter" data-level="3.2.4" data-path="1_preprocessing.html"><a href="1_preprocessing.html#actions"><i class="fa fa-check"></i><b>3.2.4</b> Actions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="1_preprocessing.html"><a href="1_preprocessing.html#check-spaces-in-birds"><i class="fa fa-check"></i><b>3.3</b> Check spaces in <code>birds</code></a></li>
<li class="chapter" data-level="3.4" data-path="1_preprocessing.html"><a href="1_preprocessing.html#check-duplicates-waarnemingnummer-aktiecode"><i class="fa fa-check"></i><b>3.4</b> Check duplicates <code>WaarnemingNummer</code>-<code>AktieCode</code></a></li>
<li class="chapter" data-level="3.5" data-path="1_preprocessing.html"><a href="1_preprocessing.html#merge-observations-and-actions"><i class="fa fa-check"></i><b>3.5</b> Merge observations and actions</a></li>
<li class="chapter" data-level="3.6" data-path="1_preprocessing.html"><a href="1_preprocessing.html#check-spaces-in-obs_and_acts"><i class="fa fa-check"></i><b>3.6</b> Check spaces in <code>obs_and_acts</code></a></li>
<li class="chapter" data-level="3.7" data-path="1_preprocessing.html"><a href="1_preprocessing.html#check-presence-action-code"><i class="fa fa-check"></i><b>3.7</b> Check presence action code</a></li>
<li class="chapter" data-level="3.8" data-path="1_preprocessing.html"><a href="1_preprocessing.html#remove-data-labelled-as-fout"><i class="fa fa-check"></i><b>3.8</b> Remove data labelled as <code>FOUT</code></a></li>
<li class="chapter" data-level="3.9" data-path="1_preprocessing.html"><a href="1_preprocessing.html#check-color-rings-uppercase"><i class="fa fa-check"></i><b>3.9</b> Check color rings: uppercase</a></li>
<li class="chapter" data-level="3.10" data-path="1_preprocessing.html"><a href="1_preprocessing.html#check-keys-kleurringnummer-obs---nummer-birds"><i class="fa fa-check"></i><b>3.10</b> Check keys <code>KleurringNummer</code> (obs) - <code>Nummer</code> (birds)</a></li>
<li class="chapter" data-level="3.11" data-path="1_preprocessing.html"><a href="1_preprocessing.html#check-duplicates-in-date-of-applying-rings"><i class="fa fa-check"></i><b>3.11</b> Check duplicates in date of applying rings</a></li>
<li class="chapter" data-level="3.12" data-path="1_preprocessing.html"><a href="1_preprocessing.html#check-age-while-applying-rings"><i class="fa fa-check"></i><b>3.12</b> Check age while applying rings</a></li>
<li class="chapter" data-level="3.13" data-path="1_preprocessing.html"><a href="1_preprocessing.html#check-bird-sex-inconsistencies"><i class="fa fa-check"></i><b>3.13</b> Check bird sex inconsistencies</a></li>
<li class="chapter" data-level="3.14" data-path="1_preprocessing.html"><a href="1_preprocessing.html#handle-information-about-metal-ring-number"><i class="fa fa-check"></i><b>3.14</b> Handle information about metal ring number</a></li>
<li class="chapter" data-level="3.15" data-path="1_preprocessing.html"><a href="1_preprocessing.html#solve-gps-tracker-ids"><i class="fa fa-check"></i><b>3.15</b> Solve GPS tracker IDs</a></li>
<li class="chapter" data-level="3.16" data-path="1_preprocessing.html"><a href="1_preprocessing.html#check-inconsistencies-between-users-and-observers"><i class="fa fa-check"></i><b>3.16</b> Check inconsistencies between users and observers</a></li>
<li class="chapter" data-level="3.17" data-path="1_preprocessing.html"><a href="1_preprocessing.html#remove-data-of-common-shelduck"><i class="fa fa-check"></i><b>3.17</b> Remove data of common shelduck</a></li>
<li class="chapter" data-level="3.18" data-path="1_preprocessing.html"><a href="1_preprocessing.html#save-preprocessed-data"><i class="fa fa-check"></i><b>3.18</b> Save preprocessed data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="2_users.html"><a href="2_users.html"><i class="fa fa-check"></i><b>4</b> Map user data</a><ul>
<li class="chapter" data-level="4.1" data-path="2_users.html"><a href="2_users.html#read-temporary-user-data"><i class="fa fa-check"></i><b>4.1</b> Read temporary user data</a></li>
<li class="chapter" data-level="4.2" data-path="2_users.html"><a href="2_users.html#map-user-data-1"><i class="fa fa-check"></i><b>4.2</b> Map user data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="2_users.html"><a href="2_users.html#e-mail"><i class="fa fa-check"></i><b>4.2.1</b> E-mail</a></li>
<li class="chapter" data-level="4.2.2" data-path="2_users.html"><a href="2_users.html#first-name"><i class="fa fa-check"></i><b>4.2.2</b> First name</a></li>
<li class="chapter" data-level="4.2.3" data-path="2_users.html"><a href="2_users.html#last-name"><i class="fa fa-check"></i><b>4.2.3</b> Last name</a></li>
<li class="chapter" data-level="4.2.4" data-path="2_users.html"><a href="2_users.html#address"><i class="fa fa-check"></i><b>4.2.4</b> Address</a></li>
<li class="chapter" data-level="4.2.5" data-path="2_users.html"><a href="2_users.html#place"><i class="fa fa-check"></i><b>4.2.5</b> Place</a></li>
<li class="chapter" data-level="4.2.6" data-path="2_users.html"><a href="2_users.html#postal-code"><i class="fa fa-check"></i><b>4.2.6</b> Postal code</a></li>
<li class="chapter" data-level="4.2.7" data-path="2_users.html"><a href="2_users.html#country"><i class="fa fa-check"></i><b>4.2.7</b> Country</a></li>
<li class="chapter" data-level="4.2.8" data-path="2_users.html"><a href="2_users.html#user-id"><i class="fa fa-check"></i><b>4.2.8</b> User ID</a></li>
<li class="chapter" data-level="4.2.9" data-path="2_users.html"><a href="2_users.html#user-reference"><i class="fa fa-check"></i><b>4.2.9</b> User reference</a></li>
<li class="chapter" data-level="4.2.10" data-path="2_users.html"><a href="2_users.html#user-language"><i class="fa fa-check"></i><b>4.2.10</b> User language</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="2_users.html"><a href="2_users.html#save-user-data"><i class="fa fa-check"></i><b>4.3</b> Save user data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="3_birds.html"><a href="3_birds.html"><i class="fa fa-check"></i><b>5</b> Map ring data</a><ul>
<li class="chapter" data-level="5.1" data-path="3_birds.html"><a href="3_birds.html#read-temporary-ring-data"><i class="fa fa-check"></i><b>5.1</b> Read temporary ring data</a><ul>
<li class="chapter" data-level="5.1.1" data-path="3_birds.html"><a href="3_birds.html#read-observation-data"><i class="fa fa-check"></i><b>5.1.1</b> Read observation data</a></li>
<li class="chapter" data-level="5.1.2" data-path="3_birds.html"><a href="3_birds.html#read-action-data"><i class="fa fa-check"></i><b>5.1.2</b> Read action data</a></li>
<li class="chapter" data-level="5.1.3" data-path="3_birds.html"><a href="3_birds.html#read-ring-position-data"><i class="fa fa-check"></i><b>5.1.3</b> Read ring position data</a></li>
<li class="chapter" data-level="5.1.4" data-path="3_birds.html"><a href="3_birds.html#read-user-data"><i class="fa fa-check"></i><b>5.1.4</b> Read user data</a></li>
<li class="chapter" data-level="5.1.5" data-path="3_birds.html"><a href="3_birds.html#read-color-data"><i class="fa fa-check"></i><b>5.1.5</b> Read color data</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="3_birds.html"><a href="3_birds.html#map-color-ring-data"><i class="fa fa-check"></i><b>5.2</b> Map color ring data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="3_birds.html"><a href="3_birds.html#extract-action-codes"><i class="fa fa-check"></i><b>5.2.1</b> Extract action codes</a></li>
<li class="chapter" data-level="5.2.2" data-path="3_birds.html"><a href="3_birds.html#bird-reference-bird-shorthand"><i class="fa fa-check"></i><b>5.2.2</b> Bird reference &amp; bird shorthand</a></li>
<li class="chapter" data-level="5.2.3" data-path="3_birds.html"><a href="3_birds.html#bird-ringing-date"><i class="fa fa-check"></i><b>5.2.3</b> Bird ringing date</a></li>
<li class="chapter" data-level="5.2.4" data-path="3_birds.html"><a href="3_birds.html#bird-ringing-end-date"><i class="fa fa-check"></i><b>5.2.4</b> Bird ringing end date</a></li>
<li class="chapter" data-level="5.2.5" data-path="3_birds.html"><a href="3_birds.html#add-rows-for-metal-rings-without-color-rings"><i class="fa fa-check"></i><b>5.2.5</b> Add rows for metal rings without color rings</a></li>
<li class="chapter" data-level="5.2.6" data-path="3_birds.html"><a href="3_birds.html#position-of-the-color-ring-and-inscription-orientation"><i class="fa fa-check"></i><b>5.2.6</b> Position of the color ring and inscription orientation</a></li>
<li class="chapter" data-level="5.2.7" data-path="3_birds.html"><a href="3_birds.html#ring-number"><i class="fa fa-check"></i><b>5.2.7</b> Ring number</a></li>
<li class="chapter" data-level="5.2.8" data-path="3_birds.html"><a href="3_birds.html#euring"><i class="fa fa-check"></i><b>5.2.8</b> Euring</a></li>
<li class="chapter" data-level="5.2.9" data-path="3_birds.html"><a href="3_birds.html#scheme"><i class="fa fa-check"></i><b>5.2.9</b> Scheme</a></li>
<li class="chapter" data-level="5.2.10" data-path="3_birds.html"><a href="3_birds.html#bird-sex"><i class="fa fa-check"></i><b>5.2.10</b> Bird sex</a></li>
<li class="chapter" data-level="5.2.11" data-path="3_birds.html"><a href="3_birds.html#bird-age-ringing"><i class="fa fa-check"></i><b>5.2.11</b> Bird age ringing</a></li>
<li class="chapter" data-level="5.2.12" data-path="3_birds.html"><a href="3_birds.html#bird-id"><i class="fa fa-check"></i><b>5.2.12</b> Bird ID</a></li>
<li class="chapter" data-level="5.2.13" data-path="3_birds.html"><a href="3_birds.html#bird-bto"><i class="fa fa-check"></i><b>5.2.13</b> Bird BTO</a></li>
<li class="chapter" data-level="5.2.14" data-path="3_birds.html"><a href="3_birds.html#bird-name"><i class="fa fa-check"></i><b>5.2.14</b> Bird name</a></li>
<li class="chapter" data-level="5.2.15" data-path="3_birds.html"><a href="3_birds.html#bird-birth-year"><i class="fa fa-check"></i><b>5.2.15</b> Bird birth year</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="3_birds.html"><a href="3_birds.html#finalize-user-data"><i class="fa fa-check"></i><b>5.3</b> Finalize user data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="3_birds.html"><a href="3_birds.html#add-user-role-to-crbirding_users"><i class="fa fa-check"></i><b>5.3.1</b> Add user role to <code>crbirding_users</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="3_birds.html"><a href="3_birds.html#save-modified-temporary-observation-data"><i class="fa fa-check"></i><b>5.4</b> Save modified temporary observation data</a></li>
<li class="chapter" data-level="5.5" data-path="3_birds.html"><a href="3_birds.html#save-modified-ring-position-and-direction-table"><i class="fa fa-check"></i><b>5.5</b> Save modified ring position and direction table</a></li>
<li class="chapter" data-level="5.6" data-path="3_birds.html"><a href="3_birds.html#save-final-user-data"><i class="fa fa-check"></i><b>5.6</b> Save final user data</a></li>
<li class="chapter" data-level="5.7" data-path="3_birds.html"><a href="3_birds.html#save-final-ring-data"><i class="fa fa-check"></i><b>5.7</b> Save final ring data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="4_observations.html"><a href="4_observations.html"><i class="fa fa-check"></i><b>6</b> Map observation data</a><ul>
<li class="chapter" data-level="6.1" data-path="4_observations.html"><a href="4_observations.html#read-data"><i class="fa fa-check"></i><b>6.1</b> Read data</a><ul>
<li class="chapter" data-level="6.1.1" data-path="4_observations.html"><a href="4_observations.html#read-temporary-observation-data"><i class="fa fa-check"></i><b>6.1.1</b> Read temporary observation data</a></li>
<li class="chapter" data-level="6.1.2" data-path="4_observations.html"><a href="4_observations.html#read-action-data-1"><i class="fa fa-check"></i><b>6.1.2</b> Read action data</a></li>
<li class="chapter" data-level="6.1.3" data-path="4_observations.html"><a href="4_observations.html#read-processed-ring-data"><i class="fa fa-check"></i><b>6.1.3</b> Read processed ring data</a></li>
<li class="chapter" data-level="6.1.4" data-path="4_observations.html"><a href="4_observations.html#read-temporary-ring-data-1"><i class="fa fa-check"></i><b>6.1.4</b> Read temporary ring data</a></li>
<li class="chapter" data-level="6.1.5" data-path="4_observations.html"><a href="4_observations.html#read-ring-position-data-1"><i class="fa fa-check"></i><b>6.1.5</b> Read ring position data</a></li>
<li class="chapter" data-level="6.1.6" data-path="4_observations.html"><a href="4_observations.html#read-processed-user-data"><i class="fa fa-check"></i><b>6.1.6</b> Read processed user data</a></li>
<li class="chapter" data-level="6.1.7" data-path="4_observations.html"><a href="4_observations.html#read-list-workers-in-bird-shelters"><i class="fa fa-check"></i><b>6.1.7</b> Read list workers in bird shelters</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="4_observations.html"><a href="4_observations.html#map-color-observation-data"><i class="fa fa-check"></i><b>6.2</b> Map color observation data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="4_observations.html"><a href="4_observations.html#extract-action-codes-1"><i class="fa fa-check"></i><b>6.2.1</b> Extract action codes</a></li>
<li class="chapter" data-level="6.2.2" data-path="4_observations.html"><a href="4_observations.html#observation-id"><i class="fa fa-check"></i><b>6.2.2</b> Observation ID</a></li>
<li class="chapter" data-level="6.2.3" data-path="4_observations.html"><a href="4_observations.html#observation-reference"><i class="fa fa-check"></i><b>6.2.3</b> Observation reference</a></li>
<li class="chapter" data-level="6.2.4" data-path="4_observations.html"><a href="4_observations.html#observation-date"><i class="fa fa-check"></i><b>6.2.4</b> Observation date</a></li>
<li class="chapter" data-level="6.2.5" data-path="4_observations.html"><a href="4_observations.html#observation-time"><i class="fa fa-check"></i><b>6.2.5</b> Observation time</a></li>
<li class="chapter" data-level="6.2.6" data-path="4_observations.html"><a href="4_observations.html#observation-latitude"><i class="fa fa-check"></i><b>6.2.6</b> Observation latitude</a></li>
<li class="chapter" data-level="6.2.7" data-path="4_observations.html"><a href="4_observations.html#observation-longitude"><i class="fa fa-check"></i><b>6.2.7</b> Observation longitude</a></li>
<li class="chapter" data-level="6.2.8" data-path="4_observations.html"><a href="4_observations.html#observation-location"><i class="fa fa-check"></i><b>6.2.8</b> Observation location</a></li>
<li class="chapter" data-level="6.2.9" data-path="4_observations.html"><a href="4_observations.html#check-bird"><i class="fa fa-check"></i><b>6.2.9</b> Check bird</a></li>
<li class="chapter" data-level="6.2.10" data-path="4_observations.html"><a href="4_observations.html#user-id-1"><i class="fa fa-check"></i><b>6.2.10</b> User ID</a></li>
<li class="chapter" data-level="6.2.11" data-path="4_observations.html"><a href="4_observations.html#user-reference-1"><i class="fa fa-check"></i><b>6.2.11</b> User reference</a></li>
<li class="chapter" data-level="6.2.12" data-path="4_observations.html"><a href="4_observations.html#observer"><i class="fa fa-check"></i><b>6.2.12</b> Observer</a></li>
<li class="chapter" data-level="6.2.13" data-path="4_observations.html"><a href="4_observations.html#observer-e-mail"><i class="fa fa-check"></i><b>6.2.13</b> Observer e-mail</a></li>
<li class="chapter" data-level="6.2.14" data-path="4_observations.html"><a href="4_observations.html#reporter---ringer-number"><i class="fa fa-check"></i><b>6.2.14</b> Reporter - ringer number</a></li>
<li class="chapter" data-level="6.2.15" data-path="4_observations.html"><a href="4_observations.html#ring-number-1"><i class="fa fa-check"></i><b>6.2.15</b> Ring number</a></li>
<li class="chapter" data-level="6.2.16" data-path="4_observations.html"><a href="4_observations.html#observation-status"><i class="fa fa-check"></i><b>6.2.16</b> Observation status</a></li>
<li class="chapter" data-level="6.2.17" data-path="4_observations.html"><a href="4_observations.html#condition"><i class="fa fa-check"></i><b>6.2.17</b> Condition</a></li>
<li class="chapter" data-level="6.2.18" data-path="4_observations.html"><a href="4_observations.html#mri-metal-ring-information"><i class="fa fa-check"></i><b>6.2.18</b> MRI: metal ring information</a></li>
<li class="chapter" data-level="6.2.19" data-path="4_observations.html"><a href="4_observations.html#mapping-of-inbo-actions-to-status-condition-and-mri"><i class="fa fa-check"></i><b>6.2.19</b> Mapping of INBO actions to status, condition and MRI</a></li>
<li class="chapter" data-level="6.2.20" data-path="4_observations.html"><a href="4_observations.html#bird-age-ringing-1"><i class="fa fa-check"></i><b>6.2.20</b> Bird age ringing</a></li>
<li class="chapter" data-level="6.2.21" data-path="4_observations.html"><a href="4_observations.html#bird-sex-1"><i class="fa fa-check"></i><b>6.2.21</b> Bird sex</a></li>
<li class="chapter" data-level="6.2.22" data-path="4_observations.html"><a href="4_observations.html#capture"><i class="fa fa-check"></i><b>6.2.22</b> Capture</a></li>
<li class="chapter" data-level="6.2.23" data-path="4_observations.html"><a href="4_observations.html#bird-id-1"><i class="fa fa-check"></i><b>6.2.23</b> Bird ID</a></li>
<li class="chapter" data-level="6.2.24" data-path="4_observations.html"><a href="4_observations.html#bird-ring-position-and-inscription-direction"><i class="fa fa-check"></i><b>6.2.24</b> Bird ring position and inscription direction</a></li>
<li class="chapter" data-level="6.2.25" data-path="4_observations.html"><a href="4_observations.html#observation-notes"><i class="fa fa-check"></i><b>6.2.25</b> Observation notes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="4_observations.html"><a href="4_observations.html#save-final-observation-data"><i class="fa fa-check"></i><b>6.3</b> Save final observation data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mapping INBO color ring data to SOVON format</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="map-observation-data" class="section level1">
<h1><span class="header-section-number">6</span> Map observation data</h1>
<div id="read-data" class="section level2">
<h2><span class="header-section-number">6.1</span> Read data</h2>
<div id="read-temporary-observation-data" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Read temporary observation data</h3>
<p>We start from the tempoary observation data saved as TSV file in <code>data\interim</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(
  here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;interim&quot;</span>, <span class="st">&quot;obs_and_actions.tsv&quot;</span>), 
  <span class="dt">col_types =</span> <span class="kw">cols</span>(
    <span class="dt">.default =</span> <span class="kw">col_character</span>(),
    <span class="dt">sovon_bird_reference =</span> <span class="kw">col_double</span>(),
    <span class="dt">Nummer =</span> <span class="kw">col_double</span>(),
    <span class="dt">Datum =</span> <span class="kw">col_datetime</span>(<span class="dt">format =</span> <span class="st">&quot;&quot;</span>),
    <span class="dt">WaarnemerNummer =</span> <span class="kw">col_double</span>(),
    <span class="dt">PlaatsLengtegraadGraden =</span> <span class="kw">col_double</span>(),
    <span class="dt">PlaatsLengtegraadMinuten =</span> <span class="kw">col_double</span>(),
    <span class="dt">PlaatsLengtegraadSeconden =</span> <span class="kw">col_double</span>(),
    <span class="dt">PlaatsBreedtegraadGraden =</span> <span class="kw">col_double</span>(),
    <span class="dt">PlaatsBreedtegraadMinuten =</span> <span class="kw">col_double</span>(),
    <span class="dt">PlaatsBreedtegraadSeconden =</span> <span class="kw">col_double</span>(),
    <span class="dt">BevestigingDatum =</span> <span class="kw">col_datetime</span>(<span class="dt">format =</span> <span class="st">&quot;&quot;</span>),
    <span class="dt">AanmaakDatum =</span> <span class="kw">col_datetime</span>(<span class="dt">format =</span> <span class="st">&quot;&quot;</span>),
    <span class="dt">WijzigDatum =</span> <span class="kw">col_datetime</span>(<span class="dt">format =</span> <span class="st">&quot;&quot;</span>))
)</code></pre>
</div>
<div id="read-action-data-1" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Read action data</h3>
<p>Import action codes and relative meaning:</p>
<pre class="sourceCode r"><code class="sourceCode r">actions_meaning &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;input&quot;</span>, <span class="st">&quot;actions_meaning.tsv&quot;</span>))</code></pre>
</div>
<div id="read-processed-ring-data" class="section level3">
<h3><span class="header-section-number">6.1.3</span> Read processed ring data</h3>
<p>We import finalized ring data from <code>./data/processed</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">crbirding_birds &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(
  here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;processed&quot;</span>, <span class="st">&quot;crbirding_birds.tsv&quot;</span>), 
  <span class="dt">col_types =</span> <span class="kw">cols</span>(
    <span class="dt">.default =</span> <span class="kw">col_character</span>(),
    <span class="dt">bird_id =</span> <span class="kw">col_logical</span>(),
    <span class="dt">bird_reference =</span> <span class="kw">col_double</span>(),
    <span class="dt">bird_bto =</span> <span class="kw">col_logical</span>(),
    <span class="dt">bird_birth_year =</span> <span class="kw">col_logical</span>(),
    <span class="dt">bird_date_begin =</span> <span class="kw">col_datetime</span>(<span class="dt">format =</span> <span class="st">&quot;&quot;</span>),
    <span class="dt">bird_date_end =</span> <span class="kw">col_datetime</span>(<span class="dt">format =</span> <span class="st">&quot;&quot;</span>))
)</code></pre>
</div>
<div id="read-temporary-ring-data-1" class="section level3">
<h3><span class="header-section-number">6.1.4</span> Read temporary ring data</h3>
<p>We will need some columns from original INBO ring data. We import the temporary ring data as well:</p>
<pre class="sourceCode r"><code class="sourceCode r">birds &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(
  here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;interim&quot;</span>, <span class="st">&quot;birds.tsv&quot;</span>), 
  <span class="dt">col_types =</span> <span class="kw">cols</span>(
    <span class="dt">.default =</span> <span class="kw">col_character</span>())
)</code></pre>
</div>
<div id="read-ring-position-data-1" class="section level3">
<h3><span class="header-section-number">6.1.5</span> Read ring position data</h3>
<p>We import mapping of ring position and inscription reading direction:</p>
<pre class="sourceCode r"><code class="sourceCode r">ring_position_table &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(
  here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;interim&quot;</span>, <span class="st">&quot;ring_position_table.tsv&quot;</span>),
  <span class="dt">na =</span> <span class="st">&quot;&quot;</span>,
  <span class="dt">col_types =</span> <span class="kw">cols</span>(
    <span class="dt">.default =</span> <span class="kw">col_character</span>(),
    <span class="dt">Aktief =</span> <span class="kw">col_logical</span>())
)</code></pre>
</div>
<div id="read-processed-user-data" class="section level3">
<h3><span class="header-section-number">6.1.6</span> Read processed user data</h3>
<p>We import finalized user data from <code>./data/processed</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">crbirding_users &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(
  here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;processed&quot;</span>, <span class="st">&quot;crbirding_users.tsv&quot;</span>), 
  <span class="dt">col_types =</span> <span class="kw">cols</span>(
    <span class="dt">.default =</span> <span class="kw">col_character</span>(),
    <span class="dt">user_id =</span> <span class="kw">col_logical</span>(),
    <span class="dt">user_reference =</span> <span class="kw">col_double</span>())
)</code></pre>
</div>
<div id="read-list-workers-in-bird-shelters" class="section level3">
<h3><span class="header-section-number">6.1.7</span> Read list workers in bird shelters</h3>
<pre class="sourceCode r"><code class="sourceCode r">workers_bird_shelters &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(
  here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;input&quot;</span>, <span class="st">&quot;workers_in_bird_shelters.tsv&quot;</span>),
    <span class="dt">col_types =</span> <span class="kw">cols</span>(
    <span class="dt">.default =</span> <span class="kw">col_character</span>(),
    <span class="dt">user_id =</span> <span class="kw">col_logical</span>(),
    <span class="dt">user_reference =</span> <span class="kw">col_double</span>())
)</code></pre>
</div>
</div>
<div id="map-color-observation-data" class="section level2">
<h2><span class="header-section-number">6.2</span> Map color observation data</h2>
<div id="extract-action-codes-1" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Extract action codes</h3>
<p>Actions present in <code>obs_and_acts</code> :</p>
<pre class="sourceCode r"><code class="sourceCode r">acts &lt;-<span class="st"> </span>actions_meaning<span class="op">$</span>Code
acts &lt;-<span class="st"> </span>acts[acts <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(obs_and_acts)]
acts</code></pre>
<pre><code>##  [1] &quot;rngkl&quot; &quot;rngme&quot; &quot;klgev&quot; &quot;br&quot;    &quot;vang&quot;  &quot;dood&quot;  &quot;klweg&quot; &quot;veld&quot; 
##  [9] &quot;meweg&quot; &quot;me&quot;    &quot;vangl&quot; &quot;ziek&quot;</code></pre>
<p>Combinations of actions present in observations:</p>
<pre class="sourceCode r"><code class="sourceCode r">action_combinations &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(acts) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">distinct</span>()
action_combinations</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rngkl"],"name":[1],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[2],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[3],"type":["chr"],"align":["left"]},{"label":["br"],"name":[4],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[6],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[7],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[8],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[9],"type":["chr"],"align":["left"]},{"label":["me"],"name":[10],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[11],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[12],"type":["chr"],"align":["left"]}],"data":[{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"me","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"me","11":"NA","12":"NA"},{"1":"rngkl","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"klgev","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"meweg","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"ziek"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="observation-id" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Observation ID</h3>
<p>The field <code>sovon_observation_id</code> is left to SOVON:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_observation_id =</span> <span class="ot">NA</span>)</code></pre>
</div>
<div id="observation-reference" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Observation reference</h3>
<p>The observation reference is an unique identifier assigned to each observation. This field exists already: <code>Nummer</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_observation_reference =</span> Nummer)</code></pre>
</div>
<div id="observation-date" class="section level3">
<h3><span class="header-section-number">6.2.4</span> Observation date</h3>
<p>The date is saved in column <code>Datum</code>. We copy it in required column <code>sovon_observation_date</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_observation_date =</span> Datum)</code></pre>
</div>
<div id="observation-time" class="section level3">
<h3><span class="header-section-number">6.2.5</span> Observation time</h3>
<p>There is no observation time in <code>obs_and_acts</code>. <code>NA</code> is given to <code>sovon_observation_time</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_observation_time =</span> <span class="ot">NA</span>)</code></pre>
</div>
<div id="observation-latitude" class="section level3">
<h3><span class="header-section-number">6.2.6</span> Observation latitude</h3>
<p>Observation latitude should be converted to decimal degrees:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">sovon_observation_lat =</span> <span class="kw">conv_unit</span>(
      <span class="kw">str_c</span>(PlaatsBreedtegraadGraden,
            PlaatsBreedtegraadMinuten,
            PlaatsBreedtegraadSeconden, 
            <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>), 
      <span class="dt">from =</span> <span class="st">&#39;deg_min_sec&#39;</span>, <span class="dt">to =</span> <span class="st">&#39;dec_deg&#39;</span>)
)</code></pre>
</div>
<div id="observation-longitude" class="section level3">
<h3><span class="header-section-number">6.2.7</span> Observation longitude</h3>
<p>Observation longitude should be converted to decimal degrees:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">sovon_observation_lng =</span> <span class="kw">conv_unit</span>(
      <span class="kw">str_c</span>(PlaatsLengtegraadGraden,
            PlaatsLengtegraadMinuten,
            PlaatsLengtegraadSeconden, 
            <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>), 
      <span class="dt">from =</span> <span class="st">&#39;deg_min_sec&#39;</span>, <span class="dt">to =</span> <span class="st">&#39;dec_deg&#39;</span>)
)</code></pre>
</div>
<div id="observation-location" class="section level3">
<h3><span class="header-section-number">6.2.8</span> Observation location</h3>
<p>Aggregate information about observation location. We follow the following structure: <code>PlaatsGemeente</code> [+ <code>,</code> + <code>PlaatsToponym</code> [+ <code>:</code> + <code>PlaatsToponymDetail</code>]]:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">sovon_observation_location =</span> <span class="kw">ifelse</span>(<span class="op">!</span><span class="kw">is.na</span>(PlaatsToponym),
                                  <span class="kw">str_c</span>(PlaatsGemeente,
                                        PlaatsToponym, 
                                        <span class="dt">sep =</span> <span class="st">&quot;, &quot;</span>),
                                  <span class="kw">paste</span>(PlaatsGemeente))) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">sovon_observation_location =</span> <span class="kw">ifelse</span>(<span class="op">!</span><span class="kw">is.na</span>(PlaatsToponymDetail),
                                  <span class="kw">str_c</span>(sovon_observation_location,
                                        PlaatsToponymDetail,
                                        <span class="dt">sep =</span> <span class="st">&quot;: &quot;</span>),
                                  <span class="kw">paste</span>(sovon_observation_location)))</code></pre>
</div>
<div id="check-bird" class="section level3">
<h3><span class="header-section-number">6.2.9</span> Check bird</h3>
<p>The field <code>sovon_check_bird</code> is provided by SOVON. <code>NA</code> is given:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_check_bird =</span> <span class="ot">NA</span>)</code></pre>
</div>
<div id="user-id-1" class="section level3">
<h3><span class="header-section-number">6.2.10</span> User ID</h3>
<p>The field <code>sovon_user_id</code> is left to SOVON:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_user_id =</span> <span class="ot">NA</span>)</code></pre>
</div>
<div id="user-reference-1" class="section level3">
<h3><span class="header-section-number">6.2.11</span> User reference</h3>
<p>The field <code>sovon_user_reference</code> links observations to users and it is equal to field <code>user_reference</code> in user data:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_user_reference =</span> WaarnemerNummer)</code></pre>
</div>
<div id="observer" class="section level3">
<h3><span class="header-section-number">6.2.12</span> Observer</h3>
<p>The field <code>sovon_melder</code> is equal to <code>user_first_name</code> and <code>user_last_name</code> in <code>users</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(
    crbirding_users <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw">select</span>(user_reference, user_first_name, user_last_name),
    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;WaarnemerNummer&quot;</span> =<span class="st"> &quot;user_reference&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_melder =</span> <span class="kw">case_when</span>(
    <span class="kw">is.na</span>(user_first_name) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(user_last_name) <span class="op">~</span><span class="st"> </span>user_last_name,
    <span class="op">!</span><span class="kw">is.na</span>(user_first_name) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(user_last_name) <span class="op">~</span><span class="st"> </span>user_first_name,
    <span class="op">!</span><span class="kw">is.na</span>(user_first_name) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(user_last_name) <span class="op">~</span><span class="st"> </span><span class="kw">str_c</span>(user_first_name, user_last_name, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>),
    <span class="kw">is.na</span>(user_first_name) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(user_last_name) <span class="op">~</span><span class="st"> </span><span class="ot">NA_character_</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(user_first_name, user_last_name))</code></pre>
</div>
<div id="observer-e-mail" class="section level3">
<h3><span class="header-section-number">6.2.13</span> Observer e-mail</h3>
<p>The field <code>sovon_melder_email</code> is equal to <code>user_email</code> in <code>users</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(
    crbirding_users <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw">select</span>(user_reference, user_email),
    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;WaarnemerNummer&quot;</span> =<span class="st"> &quot;user_reference&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_melder_email =</span> user_email)</code></pre>
</div>
<div id="reporter---ringer-number" class="section level3">
<h3><span class="header-section-number">6.2.14</span> Reporter - ringer number</h3>
<p>The field <code>sovon_melder_ringersnummer</code> is left to SOVON:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_melder_ringersnummer =</span> <span class="ot">NA</span>)</code></pre>
</div>
<div id="ring-number-1" class="section level3">
<h3><span class="header-section-number">6.2.15</span> Ring number</h3>
<p>The field <code>sovon_ring_number</code> contains information about the metal ring number, in the same format as in field <code>bird_ring_number</code> of <code>crbirding_birds</code>. As explained in the mapping of field <code>bird_ring_number</code> of <code>crbirding_birds</code>, INBO database is a color ring database. This field is not accurately mapped and we will leave it empty.</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_ring_number =</span> <span class="ot">NA_character_</span>)</code></pre>
</div>
<div id="observation-status" class="section level3">
<h3><span class="header-section-number">6.2.16</span> Observation status</h3>
<p>Adding the EURING status information arises by the need of mapping the observations with action code <code>br</code> and <code>vang</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">actions_meaning <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(Code <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;br&quot;</span>, <span class="st">&quot;vang&quot;</span>))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Code"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Beschrijving"],"name":[2],"type":["chr"],"align":["left"]},{"label":["BeschrijvingUK"],"name":[3],"type":["chr"],"align":["left"]},{"label":["CodeExtern"],"name":[4],"type":["chr"],"align":["left"]},{"label":["CodeExternUK"],"name":[5],"type":["chr"],"align":["left"]},{"label":["Kolom"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"br","2":"broedend","3":"nesting","4":"br","5":"ne","6":"L"},{"1":"vang","2":"gevangen op nest","3":"caught at the nest","4":"vn","5":"vn","6":"L"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The actions <code>br</code> and <code>vang</code> refer to status <code>breeding</code> in EURING system. Based on the scheme at page 16 of <a href="https://euring.org/files/documents/E2000PLUSExchangeCodev1161.pdf">EURING Exchange Code 2000+</a> document, we define the following mapping:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_status =</span> <span class="kw">case_when</span>(
    <span class="op">!</span><span class="kw">is.na</span>(br) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(vang) <span class="op">~</span><span class="st"> &quot;N&quot;</span>,
    LeeftijdCode <span class="op">==</span><span class="st"> &quot;PU&quot;</span> <span class="op">~</span><span class="st"> &quot;-&quot;</span>,
    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;U&quot;</span>
  ))</code></pre>
</div>
<div id="condition" class="section level3">
<h3><span class="header-section-number">6.2.17</span> Condition</h3>
<p>The SOVON field <code>condition</code> is mapped following the scheme at page 22 of <a href="https://euring.org/files/documents/E2000PLUSExchangeCodev1161.pdf">EURING Exchange Code 2000+</a> document. The following actions are mapped as follows in order of priority:</p>
<ol style="list-style-type: decimal">
<li><code>dood</code>: condition = 1</li>
<li><code>ziek</code>: condition = 4</li>
<li><code>rngkl</code>, <code>rngme</code>, <code>vang</code>, <code>vangl</code>: condition = 8</li>
<li><code>veld</code>, <code>me</code>, <code>meweg</code>, <code>br</code>: condition = 7</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_condition =</span> <span class="kw">case_when</span>(
    dood <span class="op">==</span><span class="st"> &quot;dood&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,
    klgev <span class="op">==</span><span class="st"> &quot;klgev&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,
    ziek <span class="op">==</span><span class="st"> &quot;ziek&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>,
    <span class="op">!</span><span class="kw">is.na</span>(rngkl) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(rngme) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(vang) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(vangl)  <span class="op">~</span><span class="st"> </span><span class="dv">8</span>,
    <span class="op">!</span><span class="kw">is.na</span>(veld) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(me) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(meweg) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(br)  <span class="op">~</span><span class="st"> </span><span class="dv">7</span>
    )
)</code></pre>
<p>The observations of sick birds not anymore released should get condition equal to 5. These observations are linked to the very last <code>ziek</code> action and followed by an observation with action <code>dood</code>. Not only, but the observer should be a worker of a bird shelter, in <code>workers_bird_shelters</code>.</p>
<p>Reference number of observations with condition 5:</p>
<pre class="sourceCode r"><code class="sourceCode r">last_sick_df &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(sovon_melder_ringersnummer <span class="op">%in%</span><span class="st"> </span>workers_bird_shelters<span class="op">$</span>user_reference) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(ziek <span class="op">==</span><span class="st"> &quot;ziek&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(sovon_bird_reference) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(sovon_observation_date <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(sovon_observation_date)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(sovon_observation_reference, sovon_bird_reference, sovon_observation_date) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">last_sick_date =</span> sovon_observation_date,
         <span class="dt">obs_ref =</span> sovon_observation_reference)
dead_df &lt;-
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(dood <span class="op">==</span><span class="st"> &quot;dood&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(sovon_bird_reference, sovon_observation_date) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">dead_date =</span> sovon_observation_date)
last_sick_df &lt;-<span class="st"> </span>
<span class="st">  </span>last_sick_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(sovon_bird_reference <span class="op">%in%</span><span class="st"> </span>dead_df<span class="op">$</span>sovon_bird_reference) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(dead_df, <span class="dt">by =</span> <span class="st">&quot;sovon_bird_reference&quot;</span>)

condition_<span class="dv">5</span>_obs_ref &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(sovon_bird_reference <span class="op">%in%</span><span class="st"> </span>last_sick_df<span class="op">$</span>sovon_bird_reference) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(last_sick_df,
            <span class="dt">by =</span> <span class="st">&quot;sovon_bird_reference&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(sovon_bird_reference) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(sovon_observation_date <span class="op">&gt;=</span><span class="st"> </span>last_sick_date <span class="op">&amp;</span><span class="st"> </span>
<span class="st">           </span>sovon_observation_date <span class="op">&lt;</span><span class="st"> </span>dead_date) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co">## only one ziek action present -&gt; no obs possible if not released</span>
<span class="st">  </span><span class="kw">filter</span>(n <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(last_sick_df,
            <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;sovon_bird_reference&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">pull</span>(obs_ref)</code></pre>
<p>Number of observations selected to get condition code 5:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(condition_<span class="dv">5</span>_obs_ref)</code></pre>
<pre><code>## [1] 0</code></pre>
<p>Assign condition value <code>5</code> to these observations:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_condition =</span> 
           <span class="kw">if_else</span>(
             sovon_observation_reference <span class="op">%in%</span><span class="st"> </span>condition_<span class="dv">5</span>_obs_ref, 
             <span class="dv">5</span>,
             sovon_condition)
)</code></pre>
<p>Preview:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(sovon_condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(sovon_observation_reference, 
         sovon_bird_reference, 
         sovon_observation_date,
         acts)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sovon_observation_reference"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sovon_bird_reference"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sovon_observation_date"],"name":[3],"type":["S3: POSIXct"],"align":["right"]},{"label":["rngkl"],"name":[4],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[5],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[6],"type":["chr"],"align":["left"]},{"label":["br"],"name":[7],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[8],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[9],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[10],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[11],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[12],"type":["chr"],"align":["left"]},{"label":["me"],"name":[13],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[14],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[15],"type":["chr"],"align":["left"]}],"data":[],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="mri-metal-ring-information" class="section level3">
<h3><span class="header-section-number">6.2.18</span> MRI: metal ring information</h3>
<p>Metal ring information is an integer between 0 and 9. A table can be found at page 8 of <a href="https://euring.org/files/documents/E2000PLUSExchangeCodev1161.pdf">EURING Exchange Code 2000+</a> document.</p>
<p>However, SOVON uses this field to map the observations referring to the applying of any kind of ring, either color or metal, as their database is purely focussed on color rings and due to a missing field in the EURING Exchange Code 2000+ specific for color rings.</p>
<p>INBO experts explained us that all color rings are applied on tarsus, MRI: 2, while metal ring position is on tarsus or above or unknown, MRI: 1.</p>
<p>Some actions are related to this field and are mapped as follows:</p>
<ol style="list-style-type: decimal">
<li><code>rngkl</code>: MRI = 2</li>
<li><code>rngme</code> only: MRI = 1</li>
<li><code>veld</code>: MRI = 4</li>
<li><code>me</code>: MRI = 4</li>
<li><code>br</code>: MRI = 4</li>
<li><code>klgev</code>: MRI = 4</li>
<li><code>dood</code> only: MRI = 4</li>
<li><code>vang</code>: MRI = 4 or 5</li>
<li><code>vangl</code>: MRI = 4 or 5</li>
<li><code>meweg</code> only or combined with actions not mapped yet: MRI = 4</li>
<li><code>klweg</code> only or combined with actions not mapped yet: MRI = 4</li>
<li><code>ziek</code> only: MRI = 4</li>
</ol>
<p>We initialize <code>sovon_MRI</code> by mapping first 6 situations:</p>
<pre class="sourceCode r"><code class="sourceCode r">mapping_acts_to_MRI &lt;-<span class="st"> </span>
<span class="st">  </span>action_combinations <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_MRI =</span> <span class="kw">case_when</span>(
    rngkl <span class="op">==</span><span class="st"> &quot;rngkl&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,
    rngme <span class="op">==</span><span class="st"> &quot;rngme&quot;</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(rngkl) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,
    veld <span class="op">==</span><span class="st"> &quot;veld&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>,
    me <span class="op">==</span><span class="st"> &quot;me&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>,
    br <span class="op">==</span><span class="st">  &quot;br&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>,
    klgev <span class="op">==</span><span class="st"> &quot;klgev&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>
  )
)
mapping_acts_to_MRI</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rngkl"],"name":[1],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[2],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[3],"type":["chr"],"align":["left"]},{"label":["br"],"name":[4],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[6],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[7],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[8],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[9],"type":["chr"],"align":["left"]},{"label":["me"],"name":[10],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[11],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[12],"type":["chr"],"align":["left"]},{"label":["sovon_MRI"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"2"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"2"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1"},{"1":"NA","2":"NA","3":"klgev","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"NA"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"2"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"ziek","13":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The other six conditions will be mapped directly in observations, but first we apply the provisional mapping provided by <code>mapping_acts_to_MRI</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(mapping_acts_to_MRI, <span class="dt">by =</span> <span class="kw">c</span>(acts))</code></pre>
<p>Number of observations with MRI value:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(sovon_MRI)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>()</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["n"],"name":[1],"type":["int"],"align":["right"]}],"data":[{"1":"134068"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Number of observations still to map:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(sovon_MRI)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>()</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["n"],"name":[1],"type":["int"],"align":["right"]}],"data":[{"1":"948"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Observations linked to action <code>dood</code> only, get MRI 4:</p>
<pre class="sourceCode r"><code class="sourceCode r">dood_only_number &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter_at</span>(<span class="kw">vars</span>(acts[acts <span class="op">!=</span><span class="st"> &quot;dood&quot;</span>]), <span class="kw">all_vars</span>(<span class="kw">is.na</span>(.))) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">pull</span>(sovon_observation_reference)
obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_MRI =</span> <span class="kw">if_else</span>(
    sovon_observation_reference <span class="op">%in%</span><span class="st"> </span>dood_only_number, <span class="dv">4</span>, sovon_MRI)
)</code></pre>
<p>The actions <code>vang</code> and <code>vangl</code> related to a change of color ring can be found by checking the date of the observations without action <code>rgnkl</code> or <code>rngme</code> and with same date of <code>bird_date_begin</code> in <code>crbirding_birds</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_ref_MRI_<span class="dv">5</span> &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>((<span class="op">!</span><span class="kw">is.na</span>(vang) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(vangl)) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(rngkl) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(rngme)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">inner_join</span>(crbirding_birds <span class="op">%&gt;%</span>
<span class="st">               </span><span class="kw">select</span>(bird_reference, bird_date_begin),
             <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;sovon_bird_reference&quot;</span> =<span class="st"> &quot;bird_reference&quot;</span>,
                    <span class="st">&quot;sovon_observation_date&quot;</span> =<span class="st"> &quot;bird_date_begin&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(sovon_bird_reference, sovon_observation_date) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">pull</span>(sovon_observation_reference)

obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_MRI =</span> <span class="kw">ifelse</span>(sovon_observation_reference <span class="op">%in%</span><span class="st"> </span>obs_ref_MRI_<span class="dv">5</span>, 
                            <span class="dv">5</span>, 
                            sovon_MRI)
)</code></pre>
<p>We can now assign value 4 to the other observations with action <code>vang</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">vang_no_change_color_ring &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>((<span class="op">!</span><span class="kw">is.na</span>(vang) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(vangl)) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(rngkl) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(rngme)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>sovon_observation_reference <span class="op">%in%</span><span class="st"> </span>obs_ref_MRI_<span class="dv">5</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">pull</span>(sovon_observation_reference)

obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_MRI =</span> <span class="kw">ifelse</span>(
    sovon_observation_reference <span class="op">%in%</span><span class="st"> </span>vang_no_change_color_ring, <span class="dv">4</span>, sovon_MRI
    )
)</code></pre>
<p>The mapping of MRI related to observations with action <code>vang</code> is completed:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(vang)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(sovon_bird_reference, 
         sovon_observation_reference, 
         sovon_MRI, 
         vang) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(sovon_bird_reference, 
         sovon_observation_reference)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sovon_bird_reference"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sovon_observation_reference"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sovon_MRI"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["vang"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"11","2":"23393","3":"5","4":"vang"},{"1":"14","2":"42253","3":"5","4":"vang"},{"1":"15","2":"45651","3":"5","4":"vang"},{"1":"26","2":"45739","3":"5","4":"vang"},{"1":"32","2":"72506","3":"5","4":"vang"},{"1":"32","2":"87237","3":"4","4":"vang"},{"1":"35","2":"23436","3":"5","4":"vang"},{"1":"38","2":"16588","3":"5","4":"vang"},{"1":"63","2":"80248","3":"5","4":"vang"},{"1":"64","2":"23431","3":"5","4":"vang"},{"1":"72","2":"16622","3":"5","4":"vang"},{"1":"75","2":"45589","3":"5","4":"vang"},{"1":"76","2":"33471","3":"5","4":"vang"},{"1":"77","2":"45515","3":"5","4":"vang"},{"1":"80","2":"33563","3":"5","4":"vang"},{"1":"83","2":"79024","3":"5","4":"vang"},{"1":"93","2":"16162","3":"4","4":"vang"},{"1":"93","2":"16612","3":"5","4":"vang"},{"1":"97","2":"45496","3":"5","4":"vang"},{"1":"106","2":"23433","3":"5","4":"vang"},{"1":"117","2":"45507","3":"5","4":"vang"},{"1":"120","2":"33611","3":"5","4":"vang"},{"1":"127","2":"33571","3":"5","4":"vang"},{"1":"139","2":"45202","3":"4","4":"vang"},{"1":"146","2":"45460","3":"5","4":"vang"},{"1":"147","2":"45366","3":"5","4":"vang"},{"1":"156","2":"32486","3":"5","4":"vang"},{"1":"158","2":"19911","3":"5","4":"vang"},{"1":"159","2":"32612","3":"5","4":"vang"},{"1":"181","2":"45468","3":"5","4":"vang"},{"1":"200","2":"20048","3":"5","4":"vang"},{"1":"209","2":"19904","3":"5","4":"vang"},{"1":"210","2":"33601","3":"5","4":"vang"},{"1":"217","2":"16759","3":"5","4":"vang"},{"1":"219","2":"32521","3":"5","4":"vang"},{"1":"221","2":"23377","3":"5","4":"vang"},{"1":"238","2":"20014","3":"5","4":"vang"},{"1":"247","2":"23268","3":"5","4":"vang"},{"1":"270","2":"33561","3":"5","4":"vang"},{"1":"271","2":"16692","3":"5","4":"vang"},{"1":"274","2":"79004","3":"5","4":"vang"},{"1":"279","2":"13655","3":"4","4":"vang"},{"1":"279","2":"57966","3":"5","4":"vang"},{"1":"288","2":"28735","3":"5","4":"vang"},{"1":"300","2":"45657","3":"5","4":"vang"},{"1":"311","2":"33639","3":"5","4":"vang"},{"1":"322","2":"23440","3":"5","4":"vang"},{"1":"329","2":"45514","3":"5","4":"vang"},{"1":"330","2":"32553","3":"5","4":"vang"},{"1":"332","2":"29727","3":"5","4":"vang"},{"1":"337","2":"24415","3":"4","4":"vang"},{"1":"337","2":"30901","3":"4","4":"vang"},{"1":"338","2":"58566","3":"5","4":"vang"},{"1":"346","2":"30053","3":"5","4":"vang"},{"1":"348","2":"16591","3":"5","4":"vang"},{"1":"369","2":"66020","3":"5","4":"vang"},{"1":"389","2":"16767","3":"5","4":"vang"},{"1":"411","2":"32463","3":"5","4":"vang"},{"1":"425","2":"45456","3":"5","4":"vang"},{"1":"427","2":"20115","3":"5","4":"vang"},{"1":"430","2":"20023","3":"5","4":"vang"},{"1":"432","2":"20033","3":"5","4":"vang"},{"1":"480","2":"23375","3":"5","4":"vang"},{"1":"484","2":"19391","3":"5","4":"vang"},{"1":"490","2":"16665","3":"5","4":"vang"},{"1":"495","2":"80220","3":"5","4":"vang"},{"1":"509","2":"28734","3":"5","4":"vang"},{"1":"526","2":"32584","3":"5","4":"vang"},{"1":"532","2":"24412","3":"4","4":"vang"},{"1":"532","2":"33482","3":"5","4":"vang"},{"1":"534","2":"16415","3":"5","4":"vang"},{"1":"539","2":"16459","3":"5","4":"vang"},{"1":"542","2":"32566","3":"5","4":"vang"},{"1":"554","2":"45389","3":"5","4":"vang"},{"1":"587","2":"16592","3":"5","4":"vang"},{"1":"588","2":"45628","3":"5","4":"vang"},{"1":"591","2":"45725","3":"5","4":"vang"},{"1":"593","2":"45636","3":"5","4":"vang"},{"1":"598","2":"29179","3":"5","4":"vang"},{"1":"599","2":"16641","3":"5","4":"vang"},{"1":"604","2":"67238","3":"5","4":"vang"},{"1":"609","2":"16642","3":"5","4":"vang"},{"1":"610","2":"23397","3":"5","4":"vang"},{"1":"616","2":"45478","3":"5","4":"vang"},{"1":"642","2":"32554","3":"5","4":"vang"},{"1":"644","2":"32485","3":"5","4":"vang"},{"1":"679","2":"79147","3":"1","4":"vang"},{"1":"783","2":"127498","3":"5","4":"vang"},{"1":"1220","2":"103991","3":"5","4":"vang"},{"1":"1222","2":"103988","3":"4","4":"vang"},{"1":"1242","2":"92344","3":"5","4":"vang"},{"1":"1243","2":"92345","3":"5","4":"vang"},{"1":"1244","2":"92584","3":"5","4":"vang"},{"1":"1245","2":"23449","3":"5","4":"vang"},{"1":"1245","2":"92597","3":"5","4":"vang"},{"1":"1246","2":"79036","3":"5","4":"vang"},{"1":"1246","2":"92600","3":"5","4":"vang"},{"1":"1251","2":"92330","3":"5","4":"vang"},{"1":"1252","2":"16632","3":"1","4":"vang"},{"1":"1252","2":"92636","3":"5","4":"vang"},{"1":"1253","2":"92748","3":"5","4":"vang"},{"1":"1254","2":"92774","3":"5","4":"vang"},{"1":"1413","2":"121053","3":"5","4":"vang"},{"1":"1424","2":"117549","3":"5","4":"vang"},{"1":"1474","2":"118483","3":"5","4":"vang"},{"1":"1480","2":"130040","3":"5","4":"vang"},{"1":"1484","2":"84165","3":"5","4":"vang"},{"1":"1505","2":"79143","3":"4","4":"vang"},{"1":"1518","2":"83329","3":"5","4":"vang"},{"1":"1634","2":"67448","3":"4","4":"vang"},{"1":"1639","2":"57345","3":"4","4":"vang"},{"1":"1642","2":"45126","3":"4","4":"vang"},{"1":"1686","2":"107193","3":"4","4":"vang"},{"1":"1721","2":"86668","3":"4","4":"vang"},{"1":"1721","2":"109777","3":"5","4":"vang"},{"1":"1791","2":"33576","3":"1","4":"vang"},{"1":"1797","2":"79138","3":"4","4":"vang"},{"1":"1914","2":"45437","3":"1","4":"vang"},{"1":"1916","2":"45585","3":"5","4":"vang"},{"1":"2040","2":"92777","3":"5","4":"vang"},{"1":"2041","2":"92792","3":"5","4":"vang"},{"1":"2042","2":"92793","3":"5","4":"vang"},{"1":"2043","2":"92794","3":"5","4":"vang"},{"1":"2044","2":"92795","3":"5","4":"vang"},{"1":"2046","2":"92803","3":"5","4":"vang"},{"1":"2047","2":"92863","3":"5","4":"vang"},{"1":"2048","2":"92865","3":"5","4":"vang"},{"1":"2049","2":"23443","3":"1","4":"vang"},{"1":"2049","2":"92866","3":"5","4":"vang"},{"1":"2050","2":"16602","3":"1","4":"vang"},{"1":"2050","2":"92867","3":"5","4":"vang"},{"1":"2051","2":"92868","3":"5","4":"vang"},{"1":"2052","2":"23411","3":"1","4":"vang"},{"1":"2052","2":"93063","3":"5","4":"vang"},{"1":"2053","2":"93066","3":"5","4":"vang"},{"1":"2126","2":"103304","3":"5","4":"vang"},{"1":"2134","2":"102221","3":"5","4":"vang"},{"1":"2136","2":"102596","3":"5","4":"vang"},{"1":"2169","2":"103025","3":"5","4":"vang"},{"1":"2170","2":"103026","3":"5","4":"vang"},{"1":"2171","2":"16649","3":"5","4":"vang"},{"1":"2171","2":"103027","3":"5","4":"vang"},{"1":"2172","2":"103028","3":"5","4":"vang"},{"1":"2196","2":"103273","3":"5","4":"vang"},{"1":"2200","2":"103284","3":"4","4":"vang"},{"1":"2272","2":"103638","3":"5","4":"vang"},{"1":"2277","2":"103986","3":"4","4":"vang"},{"1":"2317","2":"103024","3":"5","4":"vang"},{"1":"2321","2":"103224","3":"5","4":"vang"},{"1":"2461","2":"102974","3":"5","4":"vang"},{"1":"2463","2":"103443","3":"5","4":"vang"},{"1":"2545","2":"109267","3":"5","4":"vang"},{"1":"2546","2":"110339","3":"5","4":"vang"},{"1":"2597","2":"113034","3":"5","4":"vang"},{"1":"2598","2":"113023","3":"4","4":"vang"},{"1":"2712","2":"113033","3":"5","4":"vang"},{"1":"2911","2":"117548","3":"5","4":"vang"},{"1":"3363","2":"67242","3":"1","4":"vang"},{"1":"3363","2":"107324","3":"4","4":"vang"},{"1":"3470","2":"67531","3":"4","4":"vang"},{"1":"3698","2":"109233","3":"4","4":"vang"},{"1":"3707","2":"67533","3":"4","4":"vang"},{"1":"3731","2":"79155","3":"4","4":"vang"},{"1":"3756","2":"60377","3":"5","4":"vang"},{"1":"3765","2":"94240","3":"4","4":"vang"},{"1":"3854","2":"79150","3":"5","4":"vang"},{"1":"4109","2":"123097","3":"5","4":"vang"},{"1":"4527","2":"103022","3":"5","4":"vang"},{"1":"4527","2":"124616","3":"5","4":"vang"},{"1":"4538","2":"103656","3":"5","4":"vang"},{"1":"4539","2":"103657","3":"5","4":"vang"},{"1":"4539","2":"103736","3":"4","4":"vang"},{"1":"4540","2":"103658","3":"5","4":"vang"},{"1":"4541","2":"103659","3":"5","4":"vang"},{"1":"4542","2":"79136","3":"4","4":"vang"},{"1":"4542","2":"103660","3":"5","4":"vang"},{"1":"4543","2":"103661","3":"5","4":"vang"},{"1":"4606","2":"103987","3":"5","4":"vang"},{"1":"4607","2":"45519","3":"5","4":"vang"},{"1":"4607","2":"103989","3":"5","4":"vang"},{"1":"4608","2":"103990","3":"5","4":"vang"},{"1":"4771","2":"107304","3":"5","4":"vang"},{"1":"4880","2":"109234","3":"4","4":"vang"},{"1":"4893","2":"112114","3":"5","4":"vang"},{"1":"4896","2":"81631","3":"5","4":"vang"},{"1":"4896","2":"113024","3":"5","4":"vang"},{"1":"4897","2":"113038","3":"5","4":"vang"},{"1":"4930","2":"117595","3":"5","4":"vang"},{"1":"4957","2":"117555","3":"5","4":"vang"},{"1":"5146","2":"103310","3":"4","4":"vang"},{"1":"5146","2":"113025","3":"5","4":"vang"},{"1":"5147","2":"113026","3":"5","4":"vang"},{"1":"5154","2":"113529","3":"5","4":"vang"},{"1":"5195","2":"45377","3":"1","4":"vang"},{"1":"5196","2":"45378","3":"1","4":"vang"},{"1":"5198","2":"45379","3":"1","4":"vang"},{"1":"5199","2":"45381","3":"1","4":"vang"},{"1":"5200","2":"45382","3":"1","4":"vang"},{"1":"5206","2":"45400","3":"1","4":"vang"},{"1":"5208","2":"80636","3":"5","4":"vang"},{"1":"5211","2":"45441","3":"1","4":"vang"},{"1":"5237","2":"79157","3":"4","4":"vang"},{"1":"5253","2":"67581","3":"5","4":"vang"},{"1":"5301","2":"79153","3":"4","4":"vang"},{"1":"5304","2":"72916","3":"4","4":"vang"},{"1":"5304","2":"84167","3":"5","4":"vang"},{"1":"5306","2":"45384","3":"5","4":"vang"},{"1":"5315","2":"130015","3":"5","4":"vang"},{"1":"5319","2":"79134","3":"4","4":"vang"},{"1":"5331","2":"117411","3":"4","4":"vang"},{"1":"5337","2":"84152","3":"5","4":"vang"},{"1":"5342","2":"45732","3":"1","4":"vang"},{"1":"5430","2":"45431","3":"1","4":"vang"},{"1":"5434","2":"45409","3":"1","4":"vang"},{"1":"5440","2":"45385","3":"1","4":"vang"},{"1":"5442","2":"45387","3":"1","4":"vang"},{"1":"5449","2":"94239","3":"5","4":"vang"},{"1":"5519","2":"130011","3":"5","4":"vang"},{"1":"5521","2":"79137","3":"4","4":"vang"},{"1":"5522","2":"45592","3":"1","4":"vang"},{"1":"5535","2":"45665","3":"1","4":"vang"},{"1":"5796","2":"109222","3":"4","4":"vang"},{"1":"5832","2":"79132","3":"4","4":"vang"},{"1":"5862","2":"19956","3":"1","4":"vang"},{"1":"6004","2":"79078","3":"1","4":"vang"},{"1":"6141","2":"79154","3":"4","4":"vang"},{"1":"6204","2":"67256","3":"5","4":"vang"},{"1":"6205","2":"67255","3":"1","4":"vang"},{"1":"6206","2":"72909","3":"1","4":"vang"},{"1":"6207","2":"72908","3":"1","4":"vang"},{"1":"6300","2":"72912","3":"1","4":"vang"},{"1":"6301","2":"72910","3":"1","4":"vang"},{"1":"6319","2":"107191","3":"4","4":"vang"},{"1":"6381","2":"16568","3":"1","4":"vang"},{"1":"6386","2":"32462","3":"1","4":"vang"},{"1":"6394","2":"72913","3":"5","4":"vang"},{"1":"6396","2":"79135","3":"4","4":"vang"},{"1":"6431","2":"112578","3":"5","4":"vang"},{"1":"6836","2":"88906","3":"4","4":"vang"},{"1":"6991","2":"58567","3":"1","4":"vang"},{"1":"7014","2":"60369","3":"5","4":"vang"},{"1":"7025","2":"113036","3":"5","4":"vang"},{"1":"7046","2":"128174","3":"5","4":"vang"},{"1":"7085","2":"130038","3":"5","4":"vang"},{"1":"7102","2":"107192","3":"5","4":"vang"},{"1":"7118","2":"29203","3":"1","4":"vang"},{"1":"7126","2":"66347","3":"5","4":"vang"},{"1":"7131","2":"84138","3":"5","4":"vang"},{"1":"7146","2":"79026","3":"5","4":"vang"},{"1":"7153","2":"131842","3":"5","4":"vang"},{"1":"7187","2":"67411","3":"4","4":"vang"},{"1":"7192","2":"1427","3":"1","4":"vang"},{"1":"7200","2":"27938","3":"1","4":"vang"},{"1":"7246","2":"23475","3":"1","4":"vang"},{"1":"7247","2":"23476","3":"1","4":"vang"},{"1":"7248","2":"23477","3":"1","4":"vang"},{"1":"7248","2":"86665","3":"4","4":"vang"},{"1":"7249","2":"23478","3":"1","4":"vang"},{"1":"7253","2":"23482","3":"1","4":"vang"},{"1":"7254","2":"136528","3":"4","4":"vang"},{"1":"7267","2":"130039","3":"5","4":"vang"},{"1":"7324","2":"23424","3":"5","4":"vang"},{"1":"7393","2":"129512","3":"5","4":"vang"},{"1":"7398","2":"23392","3":"1","4":"vang"},{"1":"7399","2":"23417","3":"1","4":"vang"},{"1":"7400","2":"24600","3":"1","4":"vang"},{"1":"7404","2":"94176","3":"5","4":"vang"},{"1":"7405","2":"23434","3":"5","4":"vang"},{"1":"7429","2":"107273","3":"5","4":"vang"},{"1":"7504","2":"23457","3":"1","4":"vang"},{"1":"7506","2":"23459","3":"1","4":"vang"},{"1":"7510","2":"23469","3":"1","4":"vang"},{"1":"7511","2":"1481","3":"1","4":"vang"},{"1":"7512","2":"1467","3":"1","4":"vang"},{"1":"7512","2":"16571","3":"5","4":"vang"},{"1":"7516","2":"113028","3":"5","4":"vang"},{"1":"7548","2":"78909","3":"5","4":"vang"},{"1":"7618","2":"23353","3":"1","4":"vang"},{"1":"7715","2":"106999","3":"4","4":"vang"},{"1":"7718","2":"91939","3":"5","4":"vang"},{"1":"7756","2":"79139","3":"4","4":"vang"},{"1":"7818","2":"58818","3":"4","4":"vang"},{"1":"7845","2":"16637","3":"1","4":"vang"},{"1":"7854","2":"92647","3":"5","4":"vang"},{"1":"7898","2":"81928","3":"5","4":"vang"},{"1":"7936","2":"112325","3":"4","4":"vang"},{"1":"7958","2":"67406","3":"4","4":"vang"},{"1":"7959","2":"125517","3":"5","4":"vang"},{"1":"7988","2":"67400","3":"4","4":"vang"},{"1":"7989","2":"130042","3":"5","4":"vang"},{"1":"7990","2":"16566","3":"1","4":"vang"},{"1":"8018","2":"19815","3":"1","4":"vang"},{"1":"8048","2":"16656","3":"1","4":"vang"},{"1":"8050","2":"131371","3":"5","4":"vang"},{"1":"8059","2":"16662","3":"1","4":"vang"},{"1":"8060","2":"16663","3":"1","4":"vang"},{"1":"8068","2":"16671","3":"1","4":"vang"},{"1":"8103","2":"118273","3":"4","4":"vang"},{"1":"8167","2":"79142","3":"5","4":"vang"},{"1":"8188","2":"79133","3":"4","4":"vang"},{"1":"8195","2":"107274","3":"5","4":"vang"},{"1":"8212","2":"16655","3":"1","4":"vang"},{"1":"8218","2":"16682","3":"1","4":"vang"},{"1":"8219","2":"16683","3":"1","4":"vang"},{"1":"8222","2":"32374","3":"4","4":"vang"},{"1":"8293","2":"16539","3":"1","4":"vang"},{"1":"8298","2":"81385","3":"5","4":"vang"},{"1":"8306","2":"23524","3":"4","4":"vang"},{"1":"8310","2":"16567","3":"1","4":"vang"},{"1":"8325","2":"16589","3":"1","4":"vang"},{"1":"8326","2":"16596","3":"1","4":"vang"},{"1":"8328","2":"16598","3":"1","4":"vang"},{"1":"8330","2":"16601","3":"1","4":"vang"},{"1":"8332","2":"16604","3":"1","4":"vang"},{"1":"8337","2":"16610","3":"1","4":"vang"},{"1":"8346","2":"16623","3":"1","4":"vang"},{"1":"8355","2":"16635","3":"1","4":"vang"},{"1":"8362","2":"16644","3":"1","4":"vang"},{"1":"8380","2":"23467","3":"5","4":"vang"},{"1":"8387","2":"16633","3":"1","4":"vang"},{"1":"8394","2":"16411","3":"1","4":"vang"},{"1":"8396","2":"16413","3":"5","4":"vang"},{"1":"8397","2":"57104","3":"5","4":"vang"},{"1":"8434","2":"79144","3":"4","4":"vang"},{"1":"8434","2":"107276","3":"5","4":"vang"},{"1":"8442","2":"32473","3":"4","4":"vang"},{"1":"8443","2":"79035","3":"4","4":"vang"},{"1":"8443","2":"86669","3":"4","4":"vang"},{"1":"8452","2":"19820","3":"5","4":"vang"},{"1":"8454","2":"16835","3":"5","4":"vang"},{"1":"8458","2":"16404","3":"5","4":"vang"},{"1":"8472","2":"45498","3":"5","4":"vang"},{"1":"8474","2":"72911","3":"5","4":"vang"},{"1":"8486","2":"32454","3":"5","4":"vang"},{"1":"8516","2":"24414","3":"5","4":"vang"},{"1":"8516","2":"33606","3":"4","4":"vang"},{"1":"8532","2":"79152","3":"5","4":"vang"},{"1":"8543","2":"45438","3":"5","4":"vang"},{"1":"8549","2":"32524","3":"5","4":"vang"},{"1":"8582","2":"28700","3":"5","4":"vang"},{"1":"8591","2":"32489","3":"5","4":"vang"},{"1":"8617","2":"19881","3":"5","4":"vang"},{"1":"8627","2":"20098","3":"5","4":"vang"},{"1":"8657","2":"33349","3":"5","4":"vang"},{"1":"8668","2":"45524","3":"5","4":"vang"},{"1":"8669","2":"45404","3":"5","4":"vang"},{"1":"8670","2":"23403","3":"5","4":"vang"},{"1":"8686","2":"33603","3":"5","4":"vang"},{"1":"8695","2":"24413","3":"4","4":"vang"},{"1":"8696","2":"45610","3":"5","4":"vang"},{"1":"8697","2":"16670","3":"5","4":"vang"},{"1":"8705","2":"80193","3":"5","4":"vang"},{"1":"8719","2":"23328","3":"5","4":"vang"},{"1":"8723","2":"16702","3":"5","4":"vang"},{"1":"8730","2":"55909","3":"4","4":"vang"},{"1":"8749","2":"78737","3":"5","4":"vang"},{"1":"8755","2":"32432","3":"5","4":"vang"},{"1":"8759","2":"67421","3":"5","4":"vang"},{"1":"8770","2":"16664","3":"5","4":"vang"},{"1":"8775","2":"23412","3":"5","4":"vang"},{"1":"8785","2":"32478","3":"1","4":"vang"},{"1":"8790","2":"32483","3":"1","4":"vang"},{"1":"8793","2":"32488","3":"1","4":"vang"},{"1":"8799","2":"32496","3":"1","4":"vang"},{"1":"8802","2":"32499","3":"1","4":"vang"},{"1":"8807","2":"32505","3":"5","4":"vang"},{"1":"8811","2":"32509","3":"1","4":"vang"},{"1":"8813","2":"32512","3":"1","4":"vang"},{"1":"8814","2":"79083","3":"5","4":"vang"},{"1":"8815","2":"32514","3":"1","4":"vang"},{"1":"8824","2":"32526","3":"1","4":"vang"},{"1":"8839","2":"32423","3":"1","4":"vang"},{"1":"8842","2":"32426","3":"1","4":"vang"},{"1":"8850","2":"51170","3":"4","4":"vang"},{"1":"8866","2":"51167","3":"4","4":"vang"},{"1":"8867","2":"32453","3":"1","4":"vang"},{"1":"8871","2":"32458","3":"1","4":"vang"},{"1":"8878","2":"32467","3":"1","4":"vang"},{"1":"8880","2":"79082","3":"5","4":"vang"},{"1":"8884","2":"32474","3":"1","4":"vang"},{"1":"8893","2":"32551","3":"1","4":"vang"},{"1":"8893","2":"79031","3":"4","4":"vang"},{"1":"8895","2":"32555","3":"1","4":"vang"},{"1":"8899","2":"32560","3":"1","4":"vang"},{"1":"8903","2":"32565","3":"1","4":"vang"},{"1":"8905","2":"32568","3":"1","4":"vang"},{"1":"8907","2":"32533","3":"1","4":"vang"},{"1":"8919","2":"32557","3":"1","4":"vang"},{"1":"8919","2":"109223","3":"4","4":"vang"},{"1":"8948","2":"107272","3":"5","4":"vang"},{"1":"8984","2":"109213","3":"4","4":"vang"},{"1":"9423","2":"109235","3":"4","4":"vang"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Same processing for observations with actions <code>vangl</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(vangl)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(sovon_bird_reference, 
         sovon_observation_reference, 
         sovon_MRI, 
         vangl) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(sovon_bird_reference, 
         sovon_observation_reference)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sovon_bird_reference"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sovon_observation_reference"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sovon_MRI"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["vangl"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"166","2":"16157","3":"4","4":"vangl"},{"1":"199","2":"2438","3":"4","4":"vangl"},{"1":"263","2":"16159","3":"4","4":"vangl"},{"1":"379","2":"16387","3":"4","4":"vangl"},{"1":"928","2":"116923","3":"4","4":"vangl"},{"1":"1811","2":"105662","3":"4","4":"vangl"},{"1":"2188","2":"104685","3":"4","4":"vangl"},{"1":"3008","2":"128780","3":"4","4":"vangl"},{"1":"3358","2":"89861","3":"4","4":"vangl"},{"1":"5711","2":"66344","3":"4","4":"vangl"},{"1":"7163","2":"23559","3":"4","4":"vangl"},{"1":"7324","2":"25461","3":"4","4":"vangl"},{"1":"8687","2":"24266","3":"4","4":"vangl"},{"1":"8898","2":"77940","3":"5","4":"vangl"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Check that no observations with action <code>vang</code> or <code>vangl</code> are left without a MRI value:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(vang) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(vangl)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(sovon_MRI)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">nrow</span>()</code></pre>
<pre><code>## [1] 0</code></pre>
<p>For having a better overview of the mapping, we update the table <code>mapping_acts_to_MRI</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">mapping_acts_to_MRI &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="kw">one_of</span>(acts), sovon_MRI) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">distinct</span>()
mapping_acts_to_MRI</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rngkl"],"name":[1],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[2],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[3],"type":["chr"],"align":["left"]},{"label":["br"],"name":[4],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[6],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[7],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[8],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[9],"type":["chr"],"align":["left"]},{"label":["me"],"name":[10],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[11],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[12],"type":["chr"],"align":["left"]},{"label":["sovon_MRI"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"2"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"2"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1"},{"1":"NA","2":"NA","3":"klgev","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"NA"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"2"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"ziek","13":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Combinations of actions with <code>meweg</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">mapping_acts_to_MRI <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(meweg <span class="op">==</span><span class="st"> &quot;meweg&quot;</span>)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rngkl"],"name":[1],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[2],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[3],"type":["chr"],"align":["left"]},{"label":["br"],"name":[4],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[6],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[7],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[8],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[9],"type":["chr"],"align":["left"]},{"label":["me"],"name":[10],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[11],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[12],"type":["chr"],"align":["left"]},{"label":["sovon_MRI"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Observations linked to action <code>meweg</code> not mapped yet get MRI value 4:</p>
<pre class="sourceCode r"><code class="sourceCode r">meweg_left_number &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(meweg <span class="op">==</span><span class="st"> &quot;meweg&quot;</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(sovon_MRI)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">pull</span>(sovon_observation_reference)
obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_MRI =</span> <span class="kw">if_else</span>(
    sovon_observation_reference <span class="op">%in%</span><span class="st"> </span>meweg_left_number, <span class="dv">4</span>, sovon_MRI)
)</code></pre>
<p>Update table <code>mapping_acts_to_MRI</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">mapping_acts_to_MRI &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="kw">one_of</span>(acts), sovon_MRI) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">distinct</span>()
mapping_acts_to_MRI</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rngkl"],"name":[1],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[2],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[3],"type":["chr"],"align":["left"]},{"label":["br"],"name":[4],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[6],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[7],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[8],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[9],"type":["chr"],"align":["left"]},{"label":["me"],"name":[10],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[11],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[12],"type":["chr"],"align":["left"]},{"label":["sovon_MRI"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"2"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"2"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1"},{"1":"NA","2":"NA","3":"klgev","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"NA"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"2"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"ziek","13":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Final mapping of observations with action <code>meweg</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">mapping_acts_to_MRI <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(meweg <span class="op">==</span><span class="st"> &quot;meweg&quot;</span>)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rngkl"],"name":[1],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[2],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[3],"type":["chr"],"align":["left"]},{"label":["br"],"name":[4],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[6],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[7],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[8],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[9],"type":["chr"],"align":["left"]},{"label":["me"],"name":[10],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[11],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[12],"type":["chr"],"align":["left"]},{"label":["sovon_MRI"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Action combinations still without MRI:</p>
<pre class="sourceCode r"><code class="sourceCode r">mapping_acts_to_MRI <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(sovon_MRI))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rngkl"],"name":[1],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[2],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[3],"type":["chr"],"align":["left"]},{"label":["br"],"name":[4],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[6],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[7],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[8],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[9],"type":["chr"],"align":["left"]},{"label":["me"],"name":[10],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[11],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[12],"type":["chr"],"align":["left"]},{"label":["sovon_MRI"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Observations with action <code>klweg</code> not yet mapped get MRI 4 as the metal ring is still present:</p>
<pre class="sourceCode r"><code class="sourceCode r">klweg_left_number &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(klweg <span class="op">==</span><span class="st"> &quot;klweg&quot;</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(sovon_MRI)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">pull</span>(sovon_observation_reference)
obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_MRI =</span> <span class="kw">if_else</span>(
    sovon_observation_reference <span class="op">%in%</span><span class="st"> </span>klweg_left_number, <span class="dv">4</span>, sovon_MRI)
)</code></pre>
<p>Update table <code>mapping_acts_to_MRI</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">mapping_acts_to_MRI &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="kw">one_of</span>(acts), sovon_MRI) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">distinct</span>()
mapping_acts_to_MRI</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rngkl"],"name":[1],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[2],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[3],"type":["chr"],"align":["left"]},{"label":["br"],"name":[4],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[6],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[7],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[8],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[9],"type":["chr"],"align":["left"]},{"label":["me"],"name":[10],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[11],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[12],"type":["chr"],"align":["left"]},{"label":["sovon_MRI"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"2"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"2"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1"},{"1":"NA","2":"NA","3":"klgev","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"NA"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"2"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"ziek","13":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Action combinations still without MRI:</p>
<pre class="sourceCode r"><code class="sourceCode r">mapping_acts_to_MRI <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(sovon_MRI))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rngkl"],"name":[1],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[2],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[3],"type":["chr"],"align":["left"]},{"label":["br"],"name":[4],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[6],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[7],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[8],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[9],"type":["chr"],"align":["left"]},{"label":["me"],"name":[10],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[11],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[12],"type":["chr"],"align":["left"]},{"label":["sovon_MRI"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Observations with action <code>ziek</code> only get MRI 4 as the metal ring and/or the color ring are present:</p>
<pre class="sourceCode r"><code class="sourceCode r">ziek_left_number &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(ziek <span class="op">==</span><span class="st"> &quot;ziek&quot;</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(sovon_MRI)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">pull</span>(sovon_observation_reference)
obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_MRI =</span> <span class="kw">if_else</span>(
    sovon_observation_reference <span class="op">%in%</span><span class="st"> </span>ziek_left_number, <span class="dv">4</span>, sovon_MRI)
)</code></pre>
<p>Update table <code>mapping_acts_to_MRI</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">mapping_acts_to_MRI &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="kw">one_of</span>(acts), sovon_MRI) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">distinct</span>()
mapping_acts_to_MRI</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rngkl"],"name":[1],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[2],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[3],"type":["chr"],"align":["left"]},{"label":["br"],"name":[4],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[6],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[7],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[8],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[9],"type":["chr"],"align":["left"]},{"label":["me"],"name":[10],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[11],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[12],"type":["chr"],"align":["left"]},{"label":["sovon_MRI"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"2"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"2"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1"},{"1":"NA","2":"NA","3":"klgev","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"4"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"1"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"2"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"ziek","13":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>At this stage, all action combinations should have a MRI value:</p>
<pre class="sourceCode r"><code class="sourceCode r">mapping_acts_to_MRI <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(sovon_MRI))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rngkl"],"name":[1],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[2],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[3],"type":["chr"],"align":["left"]},{"label":["br"],"name":[4],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[6],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[7],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[8],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[9],"type":["chr"],"align":["left"]},{"label":["me"],"name":[10],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[11],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[12],"type":["chr"],"align":["left"]},{"label":["sovon_MRI"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The same holds true for observations:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(sovon_MRI)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">nrow</span>()</code></pre>
<pre><code>## [1] 0</code></pre>
<p>We save the final mapping in <code>data/interim</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">mapping_acts_to_MRI  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">write_tsv</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;interim&quot;</span>, <span class="st">&quot;mapping_acts_to_MRI.tsv&quot;</span>), <span class="dt">na =</span> <span class="st">&quot;&quot;</span>)</code></pre>
</div>
<div id="mapping-of-inbo-actions-to-status-condition-and-mri" class="section level3">
<h3><span class="header-section-number">6.2.19</span> Mapping of INBO actions to status, condition and MRI</h3>
<p>The fields <code>sovon_status</code>, <code>sovon_condition</code> and <code>sovon_MRI</code> should cover all possible action combinations present in observations. Consequently, no observations should have all three fields empty:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(sovon_MRI) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(sovon_condition) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(sovon_status)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">nrow</span>()</code></pre>
<pre><code>## [1] 0</code></pre>
<p>General mapping of all action combinations present in observations:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(acts, sovon_status, sovon_condition, sovon_MRI) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">distinct</span>()</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["rngkl"],"name":[1],"type":["chr"],"align":["left"]},{"label":["rngme"],"name":[2],"type":["chr"],"align":["left"]},{"label":["klgev"],"name":[3],"type":["chr"],"align":["left"]},{"label":["br"],"name":[4],"type":["chr"],"align":["left"]},{"label":["vang"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dood"],"name":[6],"type":["chr"],"align":["left"]},{"label":["klweg"],"name":[7],"type":["chr"],"align":["left"]},{"label":["veld"],"name":[8],"type":["chr"],"align":["left"]},{"label":["meweg"],"name":[9],"type":["chr"],"align":["left"]},{"label":["me"],"name":[10],"type":["chr"],"align":["left"]},{"label":["vangl"],"name":[11],"type":["chr"],"align":["left"]},{"label":["ziek"],"name":[12],"type":["chr"],"align":["left"]},{"label":["sovon_status"],"name":[13],"type":["chr"],"align":["left"]},{"label":["sovon_condition"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["sovon_MRI"],"name":[15],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"N","14":"8","15":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"U","14":"7","15":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"-","14":"8","15":"2"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"N","14":"7","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"N","14":"7","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"U","14":"7","15":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"U","14":"8","15":"2"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"U","14":"1","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"U","14":"7","15":"4"},{"1":"rngkl","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"U","14":"8","15":"2"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"-","14":"8","15":"1"},{"1":"rngkl","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"-","14":"8","15":"2"},{"1":"NA","2":"NA","3":"klgev","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"U","14":"1","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"me","11":"NA","12":"NA","13":"-","14":"7","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"meweg","10":"NA","11":"NA","12":"NA","13":"U","14":"7","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"N","14":"8","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"-","14":"1","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"U","14":"7","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"NA","13":"U","14":"8","15":"4"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"U","14":"8","15":"1"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"N","14":"8","15":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"N","14":"8","15":"5"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"U","14":"4","15":"4"},{"1":"NA","2":"rngme","3":"NA","4":"NA","5":"vang","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"N","14":"8","15":"1"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"N","14":"7","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"NA","8":"NA","9":"meweg","10":"NA","11":"NA","12":"NA","13":"U","14":"1","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"dood","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"U","14":"1","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"-","14":"7","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"dood","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"N","14":"1","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"U","14":"NA","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"br","5":"NA","6":"NA","7":"NA","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"N","14":"7","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"klweg","8":"veld","9":"NA","10":"NA","11":"NA","12":"NA","13":"U","14":"7","15":"4"},{"1":"rngkl","2":"rngme","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"ziek","13":"U","14":"4","15":"2"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"vang","6":"NA","7":"klweg","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"N","14":"8","15":"4"},{"1":"NA","2":"NA","3":"NA","4":"NA","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"vangl","12":"ziek","13":"U","14":"4","15":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="bird-age-ringing-1" class="section level3">
<h3><span class="header-section-number">6.2.20</span> Bird age ringing</h3>
<p>The required field <code>sovon_bird_age_ringing</code> should be filled with the age of the bird as mentioned by observer. This field is present in <code>obs_and_acts</code> in field <code>Datum</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_bird_age_ringing =</span> Datum)</code></pre>
</div>
<div id="bird-sex-1" class="section level3">
<h3><span class="header-section-number">6.2.21</span> Bird sex</h3>
<p>The field <code>sovon_bird_sex</code> is equal to the bird sex in ring data:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(crbirding_birds <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">              </span><span class="kw">select</span>(bird_reference, bird_sex),
            <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;sovon_bird_reference&quot;</span> =<span class="st"> &quot;bird_reference&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">sovon_bird_sex =</span> bird_sex)</code></pre>
</div>
<div id="capture" class="section level3">
<h3><span class="header-section-number">6.2.22</span> Capture</h3>
<p>The field <code>sovon_observation_is_capture</code> can be filled by evaluating the link of observations to actions <code>vang</code> or <code>vangl</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_observation_is_capture =</span> <span class="kw">if_else</span>(
    <span class="op">!</span><span class="kw">is.na</span>(vang) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(vangl), <span class="dv">1</span>, <span class="dv">0</span>
  )
)</code></pre>
</div>
<div id="bird-id-1" class="section level3">
<h3><span class="header-section-number">6.2.23</span> Bird ID</h3>
<p>The field <code>sovon_bird_id</code> is left to SOVON:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_bird_id =</span> <span class="ot">NA</span>)</code></pre>
</div>
<div id="bird-ring-position-and-inscription-direction" class="section level3">
<h3><span class="header-section-number">6.2.24</span> Bird ring position and inscription direction</h3>
<p>Similarly to the mapping in ring data, we map the ring position and inscription reading direction in observations:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">left_join</span>(ring_position_table <span class="op">%&gt;%</span>
<span class="st">              </span><span class="kw">select</span>(Code, sovon_bird_position),
            <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;KleurringPlaats&quot;</span> =<span class="st"> &quot;Code&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(ring_position_table <span class="op">%&gt;%</span>
<span class="st">              </span><span class="kw">select</span>(Code, sovon_bird_direction),
            <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;KleurringPlaats&quot;</span> =<span class="st"> &quot;Code&quot;</span>))</code></pre>
<p>Effects of the mapping:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">distinct</span>(KleurringPlaats, sovon_bird_position, sovon_bird_direction)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["KleurringPlaats"],"name":[1],"type":["chr"],"align":["left"]},{"label":["sovon_bird_position"],"name":[2],"type":["chr"],"align":["left"]},{"label":["sovon_bird_direction"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"NA","2":"NA","3":"NA"},{"1":"RL","2":"RL","3":"NA"},{"1":"LL","2":"LL","3":"NA"},{"1":"U","2":"NA","3":"U"},{"1":"RU","2":"RL","3":"U"},{"1":"D","2":"NA","3":"D"},{"1":"RD","2":"RL","3":"D"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="observation-notes" class="section level3">
<h3><span class="header-section-number">6.2.25</span> Observation notes</h3>
<p>We copy the notes in <code>Opmerking</code> to SOVON field <code>sovon_observation_notes</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sovon_observation_notes =</span> Opmerking)</code></pre>
<p>We add a dot at the end of the notes if not present already:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">sovon_observation_notes =</span> 
      <span class="kw">if_else</span>(
        <span class="op">!</span><span class="kw">is.na</span>(sovon_observation_notes) <span class="op">&amp;</span><span class="st"> </span><span class="kw">str_length</span>(sovon_observation_notes) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>,
        <span class="kw">if_else</span>(<span class="kw">str_sub</span>(sovon_observation_notes, <span class="dv">-1</span>) <span class="op">!=</span><span class="st"> &quot;.&quot;</span>,
                <span class="kw">str_c</span>(sovon_observation_notes, <span class="st">&quot;.&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),
                sovon_observation_notes),
        sovon_observation_notes)
)</code></pre>
<p>We also add the prefix <code>&quot;INBO original notes: &quot;</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">sovon_observation_notes =</span> 
      <span class="kw">if_else</span>(
        <span class="op">!</span><span class="kw">is.na</span>(sovon_observation_notes) <span class="op">&amp;</span><span class="st"> </span><span class="kw">str_length</span>(sovon_observation_notes) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>,
        <span class="kw">str_c</span>(<span class="st">&quot;INBO original notes: &quot;</span>, sovon_observation_notes, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>),
        sovon_observation_notes)
)</code></pre>
<p>We add the note <code>no_color_ring.</code> to observations linked to action <code>klweg</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">sovon_observation_notes =</span> <span class="kw">if_else</span>(
      <span class="op">!</span><span class="kw">is.na</span>(klweg),
      <span class="kw">if_else</span>(<span class="kw">is.na</span>(sovon_observation_notes),
              <span class="st">&quot;no_color_ring.&quot;</span>,
              <span class="kw">paste</span>(<span class="st">&quot;no_color_ring.&quot;</span>, sovon_observation_notes, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)),
      sovon_observation_notes)
)</code></pre>
<p>Preview:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(klweg)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(sovon_observation_notes) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>()</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sovon_observation_notes"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"no_color_ring."},{"1":"no_color_ring."},{"1":"no_color_ring."},{"1":"no_color_ring."},{"1":"no_color_ring. INBO original notes:  afgelezen door ECONUM = Duponcheel maar kleurring nooit gemeld (verloren!?)\\r\\nmelding komt uit bestand  KBIN."},{"1":"no_color_ring. INBO original notes:  metalen ring afgelezen."}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We add the note <code>color_ring_added.</code> to observations linked to action <code>rngkl</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts &lt;-<span class="st"> </span>
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">sovon_observation_notes =</span> <span class="kw">if_else</span>(
      <span class="op">!</span><span class="kw">is.na</span>(rngkl),
      <span class="kw">if_else</span>(<span class="kw">is.na</span>(sovon_observation_notes),
              <span class="st">&quot;color_ring_added.&quot;</span>,
              <span class="kw">paste</span>(<span class="st">&quot;color_ring_added.&quot;</span>, sovon_observation_notes, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)),
      sovon_observation_notes)
)</code></pre>
<p>Preview:</p>
<pre class="sourceCode r"><code class="sourceCode r">obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(rngkl)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(sovon_observation_notes) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>()</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sovon_observation_notes"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"color_ring_added."},{"1":"color_ring_added."},{"1":"color_ring_added."},{"1":"color_ring_added."},{"1":"color_ring_added."},{"1":"color_ring_added."}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="save-final-observation-data" class="section level2">
<h2><span class="header-section-number">6.3</span> Save final observation data</h2>
<p>Select the required columns, starting with prefix <code>sovon_</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">crbirding_observations &lt;-
<span class="st">  </span>obs_and_acts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;sovon&quot;</span>))</code></pre>
<p>Remove prefix <code>sovon_</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(crbirding_observations) &lt;-<span class="st"> </span><span class="kw">str_remove_all</span>(<span class="kw">names</span>(crbirding_observations), <span class="dt">pattern =</span> <span class="st">&quot;sovon_&quot;</span>)</code></pre>
<p>The desired order of columns in <code>crbirding_observations</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">cr_obs_cols &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="st">&quot;user_id&quot;</span>, <span class="st">&quot;user_reference&quot;</span>, <span class="st">&quot;bird_id&quot;</span>, <span class="st">&quot;bird_reference&quot;</span>, <span class="st">&quot;observation_id&quot;</span>,
  <span class="st">&quot;observation_reference&quot;</span>, <span class="st">&quot;observation_date&quot;</span>, <span class="st">&quot;observation_time&quot;</span>, 
  <span class="st">&quot;observation_lat&quot;</span>, <span class="st">&quot;observation_lng&quot;</span>, <span class="st">&quot;observation_location&quot;</span>, 
  <span class="st">&quot;observation_is_capture&quot;</span>, <span class="st">&quot;observation_notes&quot;</span>, <span class="st">&quot;check_bird&quot;</span>, <span class="st">&quot;MRI&quot;</span>, <span class="st">&quot;melder&quot;</span>,
  <span class="st">&quot;melder_email&quot;</span>, <span class="st">&quot;melder_ringersnummer&quot;</span>, <span class="st">&quot;ring_number&quot;</span>, <span class="st">&quot;condition&quot;</span>, <span class="st">&quot;status&quot;</span>, 
  <span class="st">&quot;bird_age_ringing&quot;</span>, <span class="st">&quot;bird_sex&quot;</span>, <span class="st">&quot;bird_position&quot;</span>, <span class="st">&quot;bird_direction&quot;</span>
)</code></pre>
<p>Are all required columns present?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all</span>(cr_obs_cols <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(crbirding_observations)) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">  </span><span class="kw">length</span>(cr_obs_cols) <span class="op">==</span><span class="st"> </span><span class="kw">ncol</span>(crbirding_observations)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>Set column order:</p>
<pre class="sourceCode r"><code class="sourceCode r">crbirding_observations &lt;-
<span class="st">  </span>crbirding_observations <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(cr_obs_cols)</code></pre>
<p>Preview data (without personal observer data for privcay reasons):</p>
<pre class="sourceCode r"><code class="sourceCode r">crbirding_observations <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(melder, melder_email)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">head</span>(<span class="dt">n =</span> <span class="dv">10</span>)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["user_id"],"name":[1],"type":["lgl"],"align":["right"]},{"label":["user_reference"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["bird_id"],"name":[3],"type":["lgl"],"align":["right"]},{"label":["bird_reference"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["observation_id"],"name":[5],"type":["lgl"],"align":["right"]},{"label":["observation_reference"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["observation_date"],"name":[7],"type":["S3: POSIXct"],"align":["right"]},{"label":["observation_time"],"name":[8],"type":["lgl"],"align":["right"]},{"label":["observation_lat"],"name":[9],"type":["chr"],"align":["left"]},{"label":["observation_lng"],"name":[10],"type":["chr"],"align":["left"]},{"label":["observation_location"],"name":[11],"type":["chr"],"align":["left"]},{"label":["observation_is_capture"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["observation_notes"],"name":[13],"type":["chr"],"align":["left"]},{"label":["check_bird"],"name":[14],"type":["lgl"],"align":["right"]},{"label":["MRI"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["melder_ringersnummer"],"name":[16],"type":["lgl"],"align":["right"]},{"label":["ring_number"],"name":[17],"type":["chr"],"align":["left"]},{"label":["condition"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["status"],"name":[19],"type":["chr"],"align":["left"]},{"label":["bird_age_ringing"],"name":[20],"type":["S3: POSIXct"],"align":["right"]},{"label":["bird_sex"],"name":[21],"type":["chr"],"align":["left"]},{"label":["bird_position"],"name":[22],"type":["chr"],"align":["left"]},{"label":["bird_direction"],"name":[23],"type":["chr"],"align":["left"]}],"data":[{"1":"NA","2":"7","3":"NA","4":"6204","5":"NA","6":"67256","7":"2011-05-24","8":"NA","9":"51.35","10":"3.18333333333333","11":"Zeebrugge, Voorhaven: APM","12":"1","13":"INBO original notes:  294N > NGAN.","14":"NA","15":"5","16":"NA","17":"NA","18":"8","19":"N","20":"2011-05-24","21":"F","22":"NA","23":"NA"},{"1":"NA","2":"7","3":"NA","4":"6204","5":"NA","6":"67256","7":"2011-05-24","8":"NA","9":"51.35","10":"3.18333333333333","11":"Zeebrugge, Voorhaven: APM","12":"1","13":"INBO original notes:  294N > NGAN.","14":"NA","15":"5","16":"NA","17":"NA","18":"8","19":"N","20":"2011-05-24","21":"F","22":"NA","23":"NA"},{"1":"NA","2":"106","3":"NA","4":"6204","5":"NA","6":"71192","7":"2011-05-25","8":"NA","9":"51.35","10":"3.18333333333333","11":"Zeebrugge, Voorhaven","12":"0","13":"NA","14":"NA","15":"4","16":"NA","17":"NA","18":"7","19":"U","20":"2011-05-25","21":"F","22":"NA","23":"NA"},{"1":"NA","2":"106","3":"NA","4":"6204","5":"NA","6":"71192","7":"2011-05-25","8":"NA","9":"51.35","10":"3.18333333333333","11":"Zeebrugge, Voorhaven","12":"0","13":"NA","14":"NA","15":"4","16":"NA","17":"NA","18":"7","19":"U","20":"2011-05-25","21":"F","22":"NA","23":"NA"},{"1":"NA","2":"106","3":"NA","4":"6204","5":"NA","6":"71193","7":"2011-06-22","8":"NA","9":"51.35","10":"3.18333333333333","11":"Zeebrugge, Voorhaven","12":"0","13":"NA","14":"NA","15":"4","16":"NA","17":"NA","18":"7","19":"U","20":"2011-06-22","21":"F","22":"NA","23":"NA"},{"1":"NA","2":"106","3":"NA","4":"6204","5":"NA","6":"71193","7":"2011-06-22","8":"NA","9":"51.35","10":"3.18333333333333","11":"Zeebrugge, Voorhaven","12":"0","13":"NA","14":"NA","15":"4","16":"NA","17":"NA","18":"7","19":"U","20":"2011-06-22","21":"F","22":"NA","23":"NA"},{"1":"NA","2":"106","3":"NA","4":"6204","5":"NA","6":"71194","7":"2011-07-08","8":"NA","9":"51.35","10":"3.18333333333333","11":"Zeebrugge, Voorhaven","12":"0","13":"NA","14":"NA","15":"4","16":"NA","17":"NA","18":"7","19":"U","20":"2011-07-08","21":"F","22":"NA","23":"NA"},{"1":"NA","2":"106","3":"NA","4":"6204","5":"NA","6":"71194","7":"2011-07-08","8":"NA","9":"51.35","10":"3.18333333333333","11":"Zeebrugge, Voorhaven","12":"0","13":"NA","14":"NA","15":"4","16":"NA","17":"NA","18":"7","19":"U","20":"2011-07-08","21":"F","22":"NA","23":"NA"},{"1":"NA","2":"951","3":"NA","4":"6204","5":"NA","6":"72062","7":"2011-10-31","8":"NA","9":"41.1833333333333","10":"8.7","11":"Matosinhos, Strand","12":"0","13":"INBO original notes:  N.GAN.","14":"NA","15":"4","16":"NA","17":"NA","18":"7","19":"U","20":"2011-10-31","21":"F","22":"NA","23":"NA"},{"1":"NA","2":"951","3":"NA","4":"6204","5":"NA","6":"72062","7":"2011-10-31","8":"NA","9":"41.1833333333333","10":"8.7","11":"Matosinhos, Strand","12":"0","13":"INBO original notes:  N.GAN.","14":"NA","15":"4","16":"NA","17":"NA","18":"7","19":"U","20":"2011-10-31","21":"F","22":"NA","23":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Save to text file (tab separated value):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write_csv</span>(
  crbirding_observations, 
  <span class="dt">path =</span> here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;processed&quot;</span>, <span class="st">&quot;crbirding_observations.tsv&quot;</span>), 
  <span class="dt">na =</span> <span class="st">&quot;&quot;</span>
)</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="3_birds.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/inbo/sovon/blob/master/src/src/4_observations.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

</body>

</html>
